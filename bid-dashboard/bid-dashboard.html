<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUASAR Collaboration: ASM 2027 Bid Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Outfit', 'sans-serif'],
                    }
                }
            }
        }
        window.tailwindCSS = { ...window.tailwindCSS, suppressWarnings: true };
    </script>
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            color: #1e293b;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Chart Container Styling */
        .chart-container {
            position: relative;
            width: 100%;
            height: 250px;
        }

        /* Tab Transitions */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Checkbox Styling */
        .roadmap-checkbox:checked+span {
            text-decoration: line-through;
            color: #94a3b8;
        }

        /* Table Input Styling */
        .fin-table th {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #64748b;
            font-weight: 600;
            padding-bottom: 8px;
            text-align: left;
        }

        .fin-table td {
            padding: 6px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .fin-table input[type="number"] {
            width: 60px;
            padding: 4px;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            text-align: right;
            font-size: 0.875rem;
        }

        .fin-table .price-col {
            font-family: monospace;
            color: #475569;
        }

        .fin-table .subtotal-col {
            font-family: monospace;
            font-weight: 600;
            text-align: right;
            color: #0f172a;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col relative overflow-x-hidden text-slate-800">
    <!-- Background handled by CSS body gradient -->

    <!-- Header -->
    <header class="relative z-50 border-b border-indigo-100 glass-panel sticky top-0 backdrop-blur-xl shadow-sm">
        <div class="container mx-auto px-6 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4 md:gap-0">
                <div class="flex items-center gap-6">
                    <img src="assets/img/ASA_Logo_W_Text_New_420x110.png" alt="ASA Logo"
                        class="h-10 w-auto opacity-90 hover:opacity-100 transition-opacity invert">
                    <div class="hidden md:block h-8 w-px bg-slate-300/50"></div>
                    <div>
                        <h1 class="text-xl font-display font-bold tracking-tight text-slate-800 leading-tight">QUASAR
                            COLLABORATION</h1>
                        <p
                            class="text-[10px] text-indigo-700 uppercase tracking-widest font-semibold flex items-center gap-2">
                            <span class="w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"></span>
                            ASM 2027 Bid Dashboard
                        </p>
                    </div>
                </div>
                <nav class="flex items-center gap-1">
                    <a href="index.html"
                        class="px-4 py-2 text-sm font-medium text-slate-700 hover:bg-indigo-50/50 rounded-lg transition-all">Home</a>
                    <a href="about.html"
                        class="px-4 py-2 text-sm font-medium text-slate-700 hover:bg-indigo-50/50 rounded-lg transition-all">About</a>
                    <a href="members.html"
                        class="px-4 py-2 text-sm font-medium text-slate-700 hover:bg-indigo-50/50 rounded-lg transition-all">Members</a>
                    <!-- Initiatives Dropdown -->
                    <div class="relative group">
                        <button
                            class="px-4 py-2 text-sm font-medium text-slate-700 hover:bg-indigo-50/50 rounded-lg transition-all flex items-center gap-1">
                            Initiatives
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        <div
                            class="absolute left-0 mt-1 w-48 bg-white rounded-lg shadow-xl border border-indigo-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform z-50 overflow-hidden">
                            <div class="py-1">
                                <a href="projects.html"
                                    class="block px-4 py-2 text-sm text-slate-700 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Projects</a>
                                <a href="schedule.html"
                                    class="block px-4 py-2 text-sm text-slate-700 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Schedule</a>
                            </div>
                        </div>
                    </div>
                    <a href="news.html"
                        class="px-4 py-2 text-sm font-medium text-slate-700 hover:bg-indigo-50/50 rounded-lg transition-all">News</a>
                    <a href="bid-dashboard.html"
                        class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg transition-all">ASM
                        2027 Bid</a>
                    <a href="contact.html"
                        class="px-4 py-2 text-sm font-medium text-slate-700 hover:bg-indigo-50/50 rounded-lg transition-all">Contact</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-12 gap-6">

        <!-- Navigation Sidebar -->
        <nav class="lg:col-span-3 space-y-6">
            <div class="glass-panel rounded-2xl p-5 shadow-xl">
                <p class="text-xs font-bold text-slate-400 uppercase mb-3 px-2">Navigation</p>
                <button onclick="switchTab('strategy')"
                    class="nav-btn w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors bg-indigo-500/10 text-indigo-700 hover:bg-white/40 flex items-center gap-3 active"
                    id="btn-strategy">
                    <span>üéØ</span> Strategy & Overview
                </button>
                <button onclick="switchTab('bid')"
                    class="nav-btn w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-slate-600 hover:bg-white/40 transition-colors flex items-center gap-3"
                    id="btn-bid">
                    <span>üìù</span> Bid Builder
                </button>
                <button onclick="switchTab('financials')"
                    class="nav-btn w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-white/40 text-slate-600 flex items-center gap-3"
                    id="btn-financials">
                    <span>üí∞</span> Financial Framework
                </button>
            </div>

            <!-- Critical Status Card -->
            <div class="glass-panel rounded-2xl p-5 shadow-xl border-l-4 border-l-amber-500">
                <p class="text-xs font-bold text-slate-400 uppercase mb-3">Critical Decisions</p>
                <ul class="space-y-3 text-sm">
                    <li class="flex justify-between items-center">
                        <span class="text-slate-600">Model</span>
                        <span id="status-model"
                            class="px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded text-xs font-bold">Pending</span>
                    </li>
                    <li class="flex justify-between items-center">
                        <span class="text-slate-600">Lead Venue</span>
                        <span id="status-venue"
                            class="px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded text-xs font-bold">Pending</span>
                    </li>
                    <li class="flex justify-between items-center">
                        <span class="text-slate-600">Dates</span>
                        <span id="status-date"
                            class="px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded text-xs font-bold">Pending</span>
                    </li>
                    <li class="flex justify-between items-center">
                        <span class="text-slate-600">Dinner</span>
                        <span id="status-dinner"
                            class="px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded text-xs font-bold">Pending</span>
                    </li>
                    <li class="flex justify-between items-center">
                        <span class="text-slate-600">Accomm.</span>
                        <span id="status-accom"
                            class="px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded text-xs font-bold">Pending</span>
                    </li>
                </ul>
                <!-- Export Button Moved Here -->
                <button onclick="downloadPlan()"
                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 mt-6 shadow-md hover:shadow-indigo-500/30">
                    <span>üì•</span> Export Decisions & Plan
                </button>
            </div>
        </nav>

        <!-- Content Area -->
        <div
            class="lg:col-span-9 glass-panel rounded-2xl shadow-2xl min-h-[600px] overflow-hidden flex flex-col relative">

            <!-- Tab: Strategy -->
            <div id="strategy" class="tab-content active p-6 md:p-8">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-slate-800 mb-2">The Strategic Core</h2>
                    <p class="text-slate-600 max-w-3xl">
                        This section defines the narrative heart of the bid. The pitch below is editable‚Äîclick to refine
                        your message.
                    </p>
                </div>

                <div
                    class="bg-gradient-to-br from-indigo-50 to-white border border-indigo-100 rounded-xl p-6 mb-8 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 text-9xl pointer-events-none">ü§ù</div>
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-lg font-bold text-indigo-900">The Pitch (Editable)</h3>
                        <span class="text-xs text-indigo-400 opacity-0 group-hover:opacity-100 transition-opacity">Click
                            to edit</span>
                    </div>
                    <textarea id="strategic-pitch" oninput="updateBid()"
                        class="w-full h-40 bg-transparent border-none text-slate-700 italic leading-relaxed text-lg resize-y focus:ring-0 p-0"
                        spellcheck="false">"This joint bid represents an unprecedented collaboration between three major Queensland universities (UQ, UniSQ, QUT), demonstrating the strength and unity of South-East Queensland's astrophysics community. By pooling our resources, expertise, and facilities, we can deliver an exceptional ASM while sharing the organizational burden and financial risk. This 'Unified Frontiers' approach showcases Queensland's commitment to collaborative astronomy and provides an opportunity to highlight the diverse research strengths across our institutions."</textarea>
                </div>
            </div>

            <!-- Tab: Bid Builder -->
            <div id="bid" class="tab-content p-6 md:p-8">
                <div class="mb-6 border-b border-slate-100 pb-4">
                    <h2 class="text-2xl font-bold text-slate-800 mb-2">Bid Builder & Decision Matrix</h2>
                    <p class="text-slate-600">
                        Configure the key variables. Inputs on the left update the Proposal Draft on the right in
                        real-time.
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <!-- Controls -->
                    <div class="space-y-6">
                        <!-- 1. Model (Select) -->
                        <div class="glass-card p-5 rounded-xl border border-indigo-200">
                            <label class="block text-sm font-bold text-indigo-900 mb-2">1. Operating Model</label>
                            <select id="modelSelect" onchange="updateBid()"
                                class="w-full p-2 border border-indigo-200 rounded bg-white text-slate-700 focus:ring-2 focus:ring-indigo-500 outline-none">
                                <option value="none" disabled selected>-- Choose Model --</option>
                                <option value="inhouse">In-House (University Managed)</option>
                                <option value="pco">PCO (Professional Organiser)</option>
                            </select>
                            <p id="model-hint" class="text-xs text-indigo-600 mt-2 italic">Select a model to see
                                pros/cons.</p>
                        </div>

                        <!-- 2. Venue (Select) -->
                        <div class="glass-card p-5 rounded-xl">
                            <label class="block text-sm font-bold text-slate-800 mb-2">2. Lead Venue (Hub)</label>
                            <select id="venueSelect" onchange="updateBid()"
                                class="w-full p-2 border border-slate-300 rounded bg-white text-slate-700 focus:ring-2 focus:ring-indigo-500 outline-none">
                                <option value="none" disabled selected>-- Choose Lead Venue --</option>
                                <option value="uq">UQ St Lucia</option>
                                <option value="qut">QUT Gardens Point</option>
                                <option value="unisq">UniSQ Springfield/Toowoomba</option>
                            </select>
                        </div>

                        <!-- 3. Dates (Calendar) -->
                        <div class="glass-card p-5 rounded-xl">
                            <label class="block text-sm font-bold text-slate-800 mb-2">3. Proposed Start Date</label>
                            <input type="date" id="dateInput" value="2027-07-05" onchange="updateBid()"
                                class="w-full p-2 border border-slate-300 rounded bg-white text-slate-700 focus:ring-2 focus:ring-indigo-500 outline-none">
                            <p class="text-xs text-slate-500 mt-1 italic">Calendar centered on July 2027.</p>
                        </div>

                        <!-- 4. HWWS (Text Input) -->
                        <div class="glass-card p-5 rounded-xl">
                            <label class="block text-sm font-bold text-slate-800 mb-2">4. HWWS Location</label>
                            <input type="text" id="hwwsInput" oninput="updateBid()"
                                placeholder="e.g., Sunshine Coast, Toowoomba, Gold Coast..."
                                class="w-full p-2 border border-slate-300 rounded bg-white text-slate-700 focus:ring-2 focus:ring-indigo-500 outline-none">
                        </div>

                        <!-- 5. Dinner (Text Input) -->
                        <div class="glass-card p-5 rounded-xl">
                            <label class="block text-sm font-bold text-slate-800 mb-2">5. Conference Dinner
                                Venue</label>
                            <input type="text" id="dinnerInput" oninput="updateBid()"
                                placeholder="e.g., Brisbane City Hall, Custom House..."
                                class="w-full p-2 border border-slate-300 rounded bg-white text-slate-700 focus:ring-2 focus:ring-indigo-500 outline-none">
                        </div>

                        <!-- 6. Accommodation (Select) -->
                        <div class="glass-card p-5 rounded-xl">
                            <label class="block text-sm font-bold text-slate-800 mb-2">6. Accommodation</label>
                            <select id="accomSelect" onchange="updateBid()"
                                class="w-full p-2 border border-slate-300 rounded bg-white text-slate-700 focus:ring-2 focus:ring-indigo-500 outline-none">
                                <option value="none" disabled selected>-- Choose Budget Option --</option>
                                <option value="YHA Brisbane City">YHA Brisbane City (Upper Roma St)</option>
                                <option value="Bunk Brisbane">Bunk Brisbane (Fortitude Valley)</option>
                                <option value="City Edge Brisbane">City Edge Brisbane (CBD/Turbot St)</option>
                                <option value="Somewhere To Stay">Somewhere To Stay (West End - Near UQ)</option>
                                <option value="Ibis Styles Elizabeth St">Ibis Styles Elizabeth St (CBD)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Live Proposal Preview -->
                    <div
                        class="bg-slate-900/90 backdrop-blur-md border border-white/10 text-slate-100 rounded-xl p-6 shadow-2xl relative h-fit sticky top-6">
                        <div
                            class="absolute top-4 right-4 text-xs font-mono bg-slate-800 px-2 py-1 rounded border border-slate-700">
                            DRAFT EMAIL
                        </div>
                        <h3 class="font-bold text-lg mb-4 text-white">Generated Proposal</h3>
                        <div id="proposal-output"
                            class="space-y-4 text-sm font-mono leading-relaxed opacity-90 max-h-[500px] overflow-y-auto pr-2">
                            <p class="text-slate-400 italic">Please make selections on the left to generate the
                                proposal...</p>
                        </div>
                        <button onclick="copyProposal()"
                            class="w-full bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2">
                            <span>üìã</span> Copy to Clipboard
                        </button>
                        <!-- Export Button REMOVED from here -->
                    </div>
                </div>
            </div>

            <!-- Tab: Financials (Overhauled) -->
            <div id="financials" class="tab-content p-6 md:p-8">
                <div class="mb-6 flex justify-between items-end">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-2">Financial Framework</h2>
                        <p class="text-slate-600 text-sm">
                            Revenue modeling based on 2025 Benchmarks (Online options removed).
                        </p>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-slate-500 uppercase font-bold tracking-wider">Total Est. Revenue</div>
                        <div id="total-revenue" class="text-3xl font-bold text-green-600">$0</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

                    <!-- Left Col: Tables -->
                    <div class="space-y-8">

                        <!-- Table 1: In-Person Reg -->
                        <div class="glass-card rounded-xl overflow-hidden shadow-sm">
                            <div class="bg-indigo-500/5 px-4 py-3 border-b border-white/20">
                                <h3 class="font-bold text-slate-800 text-sm">A. ASM Registration (In-Person Only)</h3>
                            </div>
                            <div class="p-4">
                                <table class="w-full fin-table text-sm">
                                    <thead>
                                        <tr>
                                            <th class="w-1/3 text-left font-bold text-slate-700 pb-2">Category</th>
                                            <th class="text-right font-bold text-slate-700 pb-2">Price ($)</th>
                                            <th class="text-right font-bold text-slate-700 pb-2">Count</th>
                                            <th class="text-right font-bold text-slate-700 pb-2">Subtotal</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-100">
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2 font-medium text-slate-700">Member Early</td>
                                            <td class="price-col py-2"><input type="number" id="price-mem-early"
                                                    value="360"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-mem-early"
                                                    value="120" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-mem-early">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2 font-medium text-slate-700">Member Late</td>
                                            <td class="price-col py-2"><input type="number" id="price-mem-late"
                                                    value="500"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-mem-late"
                                                    value="30" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-mem-late">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2 font-medium text-slate-700">Student Early</td>
                                            <td class="price-col py-2"><input type="number" id="price-stu-early"
                                                    value="200"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-stu-early"
                                                    value="80" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-stu-early">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2 font-medium text-slate-700">Student Late</td>
                                            <td class="price-col py-2"><input type="number" id="price-stu-late"
                                                    value="350"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-stu-late"
                                                    value="0" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-stu-late">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2 font-medium text-slate-700">Non-Member</td>
                                            <td class="price-col py-2"><input type="number" id="price-non-mem"
                                                    value="500"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-non-mem"
                                                    value="20" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-non-mem">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2 font-medium text-slate-700">Day Ticket</td>
                                            <td class="price-col py-2"><input type="number" id="price-day" value="150"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-day" value="10"
                                                    min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-day">$0</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Table 2: Extras -->
                        <div class="glass-card rounded-xl overflow-hidden shadow-sm">
                            <div class="bg-indigo-500/5 px-4 py-3 border-b border-white/20">
                                <h3 class="font-bold text-indigo-900 text-sm">B. Events & Extras</h3>
                            </div>
                            <div class="p-4">
                                <table class="w-full fin-table text-sm">
                                    <thead>
                                        <tr>
                                            <th class="w-1/3 text-left font-bold text-slate-700 pb-2">Category</th>
                                            <th class="text-right font-bold text-slate-700 pb-2">Price ($)</th>
                                            <th class="text-right font-bold text-slate-700 pb-2">Count</th>
                                            <th class="text-right font-bold text-slate-700 pb-2">Subtotal</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-100">
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2">HWWS (Accom)</td>
                                            <td class="price-col py-2"><input type="number" id="price-hwws-accom"
                                                    value="600"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-hwws-accom"
                                                    value="60" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-hwws-accom">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2">HWWS (Day)</td>
                                            <td class="price-col py-2"><input type="number" id="price-hwws-noaccom"
                                                    value="450"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-hwws-noaccom"
                                                    value="10" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-hwws-noaccom">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2">Dinner (Full)</td>
                                            <td class="price-col py-2"><input type="number" id="price-dinner-full"
                                                    value="135"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-dinner-full"
                                                    value="150" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-dinner-full">$0</td>
                                        </tr>
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="py-2">Dinner (Student)</td>
                                            <td class="price-col py-2"><input type="number" id="price-dinner-stu"
                                                    value="85"
                                                    class=" bg-slate-50 border border-slate-200 rounded px-2 py-1 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-200 outline-none text-right font-mono text-xs w-20"
                                                    oninput="calculateBudget()"></td>
                                            <td class="text-right py-2"><input type="number" id="input-dinner-stu"
                                                    value="80" min="0" oninput="calculateBudget()"
                                                    class=" bg-white border border-slate-200 rounded px-2 py-1 text-right outline-none focus:border-indigo-500 font-mono text-xs w-16">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-slate-700 py-2"
                                                id="sub-dinner-stu">$0</td>
                                        </tr>
                                        <tr class="bg-emerald-50/50 border-t border-emerald-100">
                                            <td class="py-3 px-2 font-bold text-emerald-800">Sponsorship</td>
                                            <td class="price-col text-center text-slate-400 py-3">-</td>
                                            <td class="text-right py-3"><input type="number" id="input-sponsor"
                                                    value="15000" min="0" style="width: 80px;"
                                                    oninput="calculateBudget()"
                                                    class=" bg-white border border-emerald-200 rounded px-2 py-1 text-right outline-none focus:border-emerald-500 font-bold font-mono text-emerald-700 text-xs w-24">
                                            </td>
                                            <td class="subtotal-col text-right font-bold text-emerald-700 text-lg py-3"
                                                id="sub-sponsor">$0</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>

                    <!-- Right Col: Graphs & Policies -->
                    <div class="space-y-6">

                        <!-- Chart 1: Revenue -->
                        <div class="glass-card p-6 rounded-xl shadow-sm">
                            <h4 class="text-xs font-bold text-slate-500 mb-2 uppercase text-center">Revenue Distribution
                            </h4>
                            <div class="chart-container">
                                <canvas id="revenueChart"></canvas>
                            </div>
                        </div>

                        <!-- Chart 2: Headcount -->
                        <div class="glass-card p-6 rounded-xl shadow-sm">
                            <h4 class="text-xs font-bold text-slate-500 mb-2 uppercase text-center">Logistics: Estimated
                                Headcount</h4>
                            <div class="chart-container">
                                <canvas id="attendeeChart"></canvas>
                            </div>
                        </div>

                        <!-- Detailed Policies Text -->
                        <div class="glass-card p-6 rounded-xl text-sm text-slate-700 space-y-4">
                            <h4 class="font-bold text-slate-900 border-b border-slate-200 pb-2">Financial Policies
                                (Mandatory)</h4>

                            <div class="grid grid-cols-1 gap-2">
                                <div>
                                    <strong class="text-indigo-700 text-xs uppercase">Refund Policy</strong>
                                    <div class="text-xs mt-1">Full (&gt;8wks), 50% (1-8wks), None (&lt;1wk).</div>
                                </div>
                                <div>
                                    <strong class="text-indigo-700 text-xs uppercase">Service Fees</strong>
                                    <div class="text-xs mt-1">In-House: Target 0% (Waiver Req). PCO: ~$25k Fee.</div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Tab: Interactive Roadmap REMOVED -->

        </div>

    </main>

    <footer class="relative z-10 border-t border-indigo-100 glass-panel mt-auto">
        <div class="container mx-auto px-6 py-8">
            <div class="text-center text-slate-600 text-sm">
                <p class="mb-2">&copy; 2026 QUASAR Collaboration. All rights reserved.</p>
                <p>Queensland Universities Astronomy & Space Research</p>
            </div>
        </div>
    </footer>

    <script>
        // --- State Management ---
        const state = {
            model: null,
            venue: null,
            date: '2027-07-05',
            hwws: '',
            dinner: '',
            accom: null,
            prices: {
                // In-Person
                memEarly: 360, memLate: 500,
                stuEarly: 200, stuLate: 350,
                nonMem: 500, day: 150,
                // Events
                hwwsAccom: 600, hwwsNoAccom: 450,
                dinnerFull: 135, dinnerStu: 85
            },
            counts: {
                memEarly: 120, memLate: 30,
                stuEarly: 80, stuLate: 0,
                nonMem: 20, day: 10,
                hwwsAccom: 60, hwwsNoAccom: 10,
                dinnerFull: 150, dinnerStu: 80,
                sponsor: 15000
            },
            roadmap: [
                {
                    phase: "Phase 1: Bid & Rights (Feb 2026)",
                    items: [
                        { text: "Agree on Lead Chair (UQ)", done: true, critical: false },
                        { text: "Select Operating Model (In-House vs PCO)", done: false, critical: true },
                        { text: "Secure Service Fee Waiver (if In-House)", done: false, critical: true },
                        { text: "Submit Proposal to ASA Council", done: false, critical: true }
                    ]
                },
                {
                    phase: "Phase 2: Foundation (Mar - Nov 2026)",
                    items: [
                        { text: "Setup Banking (Cost Centre or Trust)", done: false, critical: false },
                        { text: "Form LOC & SOC Committees", done: false, critical: false },
                        { text: "Nov 2026: Progress Report & Website Launch", done: false, critical: true }
                    ]
                },
                {
                    phase: "Phase 3: Execution (2027)",
                    items: [
                        { text: "Feb 2027: Finalize Budget", done: false, critical: false },
                        { text: "May 2027: Final Logistics Report", done: false, critical: false },
                        { text: "July 2027: Event Delivery", done: false, critical: true }
                    ]
                }
            ]
        };

        // --- Charts ---
        let revenueChart = null;
        let attendeeChart = null;

        function initCharts() {
            // 1. Revenue Doughnut
            const ctxRev = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(ctxRev, {
                type: 'doughnut',
                data: {
                    labels: ['ASM Reg', 'HWWS', 'Dinner', 'Sponsorship'],
                    datasets: [{
                        data: [0, 0, 0, 0],
                        backgroundColor: ['#4f46e5', '#10b981', '#f59e0b', '#64748b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'right', labels: { boxWidth: 12 } } },
                    cutout: '65%'
                }
            });

            // 2. Headcount Bar
            const ctxAtt = document.getElementById('attendeeChart').getContext('2d');
            attendeeChart = new Chart(ctxAtt, {
                type: 'bar',
                data: {
                    labels: ['ASM', 'HWWS', 'Dinner'],
                    datasets: [{
                        label: 'Total Headcount',
                        data: [0, 0, 0],
                        backgroundColor: ['#cbd5e1', '#10b981', '#f59e0b'],
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });

            calculateBudget();
        }

        // --- Core Logic ---
        function calculateBudget() {
            // 1. Get Values
            const getVal = (id) => parseInt(document.getElementById(id).value) || 0;
            const getPrice = (id) => parseInt(document.getElementById(id).value) || 0;

            // Update Price State
            state.prices.memEarly = getPrice('price-mem-early');
            state.prices.memLate = getPrice('price-mem-late');
            state.prices.stuEarly = getPrice('price-stu-early');
            state.prices.stuLate = getPrice('price-stu-late');
            state.prices.nonMem = getPrice('price-non-mem');
            state.prices.day = getPrice('price-day');

            state.prices.hwwsAccom = getPrice('price-hwws-accom');
            state.prices.hwwsNoAccom = getPrice('price-hwws-noaccom');
            state.prices.dinnerFull = getPrice('price-dinner-full');
            state.prices.dinnerStu = getPrice('price-dinner-stu');

            state.counts.memEarly = getVal('input-mem-early');
            state.counts.memLate = getVal('input-mem-late');
            state.counts.stuEarly = getVal('input-stu-early');
            state.counts.stuLate = getVal('input-stu-late');
            state.counts.nonMem = getVal('input-non-mem');
            state.counts.day = getVal('input-day');

            state.counts.hwwsAccom = getVal('input-hwws-accom');
            state.counts.hwwsNoAccom = getVal('input-hwws-noaccom');
            state.counts.dinnerFull = getVal('input-dinner-full');
            state.counts.dinnerStu = getVal('input-dinner-stu');
            state.counts.sponsor = getVal('input-sponsor');

            // 2. Calculate Subtotals & Update DOM
            const updateSub = (id, count, price) => {
                const sub = count * price;
                document.getElementById(id).innerText = '$' + sub.toLocaleString();
                return sub;
            };

            const subMemEarly = updateSub('sub-mem-early', state.counts.memEarly, state.prices.memEarly);
            const subMemLate = updateSub('sub-mem-late', state.counts.memLate, state.prices.memLate);
            const subStuEarly = updateSub('sub-stu-early', state.counts.stuEarly, state.prices.stuEarly);
            const subStuLate = updateSub('sub-stu-late', state.counts.stuLate, state.prices.stuLate);
            const subNonMem = updateSub('sub-non-mem', state.counts.nonMem, state.prices.nonMem);
            const subDay = updateSub('sub-day', state.counts.day, state.prices.day);

            const subHwwsAccom = updateSub('sub-hwws-accom', state.counts.hwwsAccom, state.prices.hwwsAccom);
            const subHwwsNoAccom = updateSub('sub-hwws-noaccom', state.counts.hwwsNoAccom, state.prices.hwwsNoAccom);

            const subDinnerFull = updateSub('sub-dinner-full', state.counts.dinnerFull, state.prices.dinnerFull);
            const subDinnerStu = updateSub('sub-dinner-stu', state.counts.dinnerStu, state.prices.dinnerStu);

            document.getElementById('sub-sponsor').innerText = '$' + state.counts.sponsor.toLocaleString();

            // 3. Category Totals
            const totalASM = subMemEarly + subMemLate + subStuEarly + subStuLate + subNonMem + subDay;
            const totalHWWS = subHwwsAccom + subHwwsNoAccom;
            const totalDinner = subDinnerFull + subDinnerStu;
            const grandTotal = totalASM + totalHWWS + totalDinner + state.counts.sponsor;

            // 4. Update Big Total
            document.getElementById('total-revenue').innerText = '$' + grandTotal.toLocaleString();

            // 5. Update Charts
            if (revenueChart) {
                revenueChart.data.datasets[0].data = [totalASM, totalHWWS, totalDinner, state.counts.sponsor];
                revenueChart.update();
            }
            if (attendeeChart) {
                // Headcounts
                const countASM = state.counts.memEarly + state.counts.memLate + state.counts.stuEarly + state.counts.stuLate + state.counts.nonMem + state.counts.day;
                const countHWWS = state.counts.hwwsAccom + state.counts.hwwsNoAccom;
                const countDinner = state.counts.dinnerFull + state.counts.dinnerStu;
                attendeeChart.data.datasets[0].data = [countASM, countHWWS, countDinner];
                attendeeChart.update();
            }
        }

        // Roadmap Render Removed

        function toggleTimeline(gIndex, iIndex) {
            state.roadmap[gIndex].items[iIndex].done = !state.roadmap[gIndex].items[iIndex].done;
            renderTimeline();
        }

        // Initialize Roadmap Data Structure (if not present)
        if (!state.roadmap[0].items[0].sub) {
            // Enhance existing data structure for new view if needed, 
            // but here we just use the existing structure and render it differently.
        }

        // --- Navigation ---
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('active', 'bg-indigo-500/10', 'text-indigo-700');
                el.classList.add('text-slate-600');
                el.classList.add('hover:bg-white/40');
            });
            const activeBtn = document.getElementById(`btn-${tabId}`);
            activeBtn.classList.add('active', 'bg-indigo-500/10', 'text-indigo-700');
            activeBtn.classList.remove('text-slate-600');
            activeBtn.classList.remove('hover:bg-white/40');
        }

        // --- Bid Builder Update ---
        function updateBid() {
            state.model = document.getElementById('modelSelect').value;
            state.venue = document.getElementById('venueSelect').value;
            state.date = document.getElementById('dateInput').value;
            state.hwws = document.getElementById('hwwsInput').value;
            state.dinner = document.getElementById('dinnerInput').value;
            state.accom = document.getElementById('accomSelect').value;

            const updateBadge = (id, val) => {
                const el = document.getElementById(id);
                if (!el) return;
                const isDecided = val && val !== 'none' && val !== '';
                el.textContent = isDecided ? 'Decided' : 'Pending';
                el.className = `px-2 py-0.5 rounded text-xs font-bold ${isDecided ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}`;
            };

            updateBadge('status-model', state.model);
            updateBadge('status-venue', state.venue);
            updateBadge('status-date', state.date);
            updateBadge('status-dinner', state.dinner);
            updateBadge('status-accom', state.accom);

            // Model Hint
            const hint = document.getElementById('model-hint');
            if (state.model === 'inhouse') {
                hint.textContent = "Warning: Must secure 15% Waiver. Saves ~$25k.";
                hint.className = "text-xs text-orange-600 mt-2 font-bold";
            } else if (state.model === 'pco') {
                hint.textContent = "Safe choice. Higher cost, lower admin burden.";
                hint.className = "text-xs text-green-600 mt-2 font-bold";
            } else {
                hint.textContent = "Select a model to see pros/cons.";
                hint.className = "text-xs text-indigo-600 mt-2 italic";
            }
            renderProposalText();
        }

        function renderProposalText() {
            const container = document.getElementById('proposal-output');
            const pitch = document.getElementById('strategic-pitch').value;
            const venueName = state.venue && state.venue !== 'none' ? document.getElementById('venueSelect').options[document.getElementById('venueSelect').selectedIndex].text : '[PENDING]';
            const modelName = state.model && state.model !== 'none' ? document.getElementById('modelSelect').options[document.getElementById('modelSelect').selectedIndex].text : '[PENDING]';
            const hwwsLoc = state.hwws || '[PENDING]';
            const dinnerLoc = state.dinner || '[PENDING]';
            const accomName = state.accom && state.accom !== 'none' ? state.accom : '[PENDING]';

            let dateStr = '[PENDING]';
            if (state.date) {
                const parts = state.date.split('-');
                const d = new Date(parts[0], parts[1] - 1, parts[2]);
                dateStr = "Week starting " + d.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            }

            const proposalHTML = `
                <div class="mb-4 pb-4 border-b border-slate-700">
                    <strong>1. Reason to Host:</strong><br>
                    "${pitch}"
                </div>
                <div class="mb-4">
                    <strong>2. Proposed Venues:</strong><br>
                    ASM Hub: ${venueName}<br>
                    HWWS Venue: ${hwwsLoc}
                </div>
                <div class="mb-4">
                    <strong>3. Proposed Dates:</strong><br>
                    ${dateStr}
                </div>
                <div class="mb-4">
                    <strong>4. Themes:</strong><br>
                    "Unified Frontiers" - Leveraging combined expertise in Theory, Observation, and Planetary Science.
                </div>
                <div class="mb-4">
                    <strong>5. Organization:</strong><br>
                    ${modelName}
                </div>
                <div class="mb-4">
                    <strong>6. Preliminary Costings (2025 Benchmark):</strong><br>
                    <ul class="list-disc pl-4 text-xs mt-1 space-y-1">
                        <li><strong>In-Person Member:</strong> Early $360 / Late $500</li>
                        <li><strong>In-Person Student:</strong> Early $200 / Late $350</li>
                        <li><strong>Dinner:</strong> Delegate $135 / Student $85</li>
                        <li><strong>HWWS:</strong> $600 (Accom) / $450 (Day)</li>
                    </ul>
                </div>
                <div class="mb-4">
                    <strong>7. Accommodation:</strong><br>
                    ${accomName}
                </div>
                <div class="mb-4">
                    <strong>8. Dinner Venue:</strong><br>
                    ${dinnerLoc}
                </div>
                <div class="mb-4">
                    <strong>9. Satellite Meetings:</strong><br>
                    Dedicated rooms reserved for Council, Heads of Dept, and NCA meetings.
                </div>
            `;
            container.innerHTML = proposalHTML;
        }

        function copyProposal() {
            const text = document.getElementById('proposal-output').innerText;
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            alert("Proposal copied to clipboard!");
        }

        function downloadPlan() {
            const date = new Date().toLocaleDateString();
            const pitch = document.getElementById('strategic-pitch').value;
            let content = `ASA ASM 2027 JOINT BID - EXPORTED PLAN\nDate: ${date}\n\n`;

            content += `--- 1. CORE STRATEGY: UNIFIED FRONTIERS ---\n${pitch}\n\n`;
            content += `--- 2. CORE DECISIONS ---\n`;
            content += `Operating Model: ${state.model ? state.model.toUpperCase() : 'PENDING'}\n`;
            content += `Lead Venue: ${state.venue ? state.venue.toUpperCase() : 'PENDING'}\n`;
            content += `Start Date: ${state.date || 'PENDING'}\n`;
            content += `HWWS Location: ${state.hwws || 'PENDING'}\n`;
            content += `Dinner Venue: ${state.dinner || 'PENDING'}\n`;
            content += `Accommodation: ${state.accom || 'PENDING'}\n\n`;

            content += `--- 3. FINANCIAL PROJECTIONS (2025 RATES) ---\n`;
            content += `Total Estimated Revenue: ${document.getElementById('total-revenue').innerText}\n`;
            content += `Sponsorship: $${state.counts.sponsor.toLocaleString()}\n`;
            content += `Breakdown (Count x Price):\n`;
            content += ` - Mem Early: ${state.counts.memEarly} x $360\n`;
            content += ` - Mem Late: ${state.counts.memLate} x $500\n`;
            content += ` - Stu Early: ${state.counts.stuEarly} x $200\n`;
            content += ` - Stu Late: ${state.counts.stuLate} x $350\n`;
            content += ` - Non Mem: ${state.counts.nonMem} x $500\n`;
            content += ` - HWWS (Accom): ${state.counts.hwwsAccom} x $600\n`;
            content += ` - Dinner (Full): ${state.counts.dinnerFull} x $135\n\n`;

            content += `--- 4. PROPOSAL DRAFT ---\n`;
            content += document.getElementById('proposal-output').innerText + `\n\n`;

            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ASA_ASM2027_Bid_Plan.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            initCharts();
            // renderTimeline(); // Removed
            switchTab('strategy'); // Default
        });

    </script>
</body>

</html>